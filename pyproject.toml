[build-system]
requires = ["setuptools >= 65"]
backend-path = ["./scripts"]
build-backend = "build"

[project]
name = "byted-xpu-graph"
dynamic = ["version"]
# Generated by `git log --pretty="{name='%an',email='%ae'}," | sort -u`
authors = [
  {name='jyjyjyjyjyjyjyj',email='a17621680413@163.com'},
  {name='mingfa-byted',email='wangmingfa@bytedance.com'},
  {name='yfchen-byted',email='chenyifan.42@bytedance.com'},
  {name='yhjyhj333',email='yhjyyy2024@163.com'},
  {name='zhangjihang',email='zhangjihang@bytedance.com'},
  {name='zhouyusong',email='12744832+peacewell@user.noreply.gitee.com'},
  {name='煎茶捣药',email='liuyuan.leo@bytedance.com'},
]
maintainers = [
  {name='zhangjihang',email='zhangjihang@bytedance.com'},
]
description = "A graph compiler based on Torch Dynamo."
readme = "README.md"
requires-python = ">=3.9"
dependencies = [
  "torch>=2.7.0a0,<2.8.0",
  "dataclasses",
  "numpy",
  "pyyaml",
]
classifiers = [
    "Development Status :: 3 - Alpha",
    "Programming Language :: Python :: 3 :: Only",
    "Programming Language :: Python :: 3.9",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Operating System :: POSIX :: Linux",
]
license = "Apache-2.0"
license-files = ["LICENSE.txt"]
[project.optional-dependencies]
dev = [
    "pytest >= 7.0.0",
    "pytest-cov >= 6.0.0",
    "pytest-xdist",
    "setuptools >= 65",
    "build >= 1.2.2",
    "expecttest",
    "pydot",
    "ipython",
    "pandas",
]

npu = [
    "torch==2.7.1", # Change it if you wish to use another version.
    "numpy<2",
    "decorator",
    "scipy",
    "attrs",
    "psutil",
    "protobuf",
    "byted-triton-x==3.2.0.post9",
    "pybind11",
    "torch_npu",
]

# [dependency-groups]
# local_npu = ["byted-xpu-graph[dev]", "byted-xpu-graph[npu]", "torch_npu"]
# ci_npu = ["byted-xpu-graph[dev]", "byted-xpu-graph[npu]", "torch_npu@https://tosv.byted.org/obj/seed-hhw/xllm_xpu_plugin_ci/torch_npu-2.7.1.post1.dev20251016-cp311-cp311-manylinux_2_28_x86_64.whl"]
#

[project.urls]
Homepage = "https://github.com/XPU-Forces/xpu_graph"
Issues = "https://github.com/XPU-Forces/xpu_graph/issues"

[tool.setuptools.dynamic]
version = {attr = "xpu_graph.version.__version__"}

[tool.setuptools.package-data]
"xpu_graph" = ["RELEASE.md"]

# UV section
[tool.uv]
required-version = "==0.9.10"

[[tool.uv.index]]
url = "https://bytedpypi.byted.org/simple/"

[[tool.uv.index]]
name = "pytorch_cpu"
url = "https://download.pytorch.org/whl/cpu"

[tool.uv.sources]
torch           = { index = "pytorch_cpu" }
torchvision     = { index = "pytorch_cpu" }
# DO NOT forget to change the verison here.
torch_npu       = { url = "https://tosv.byted.org/obj/seed-hhw/xllm_xpu_plugin_ci/torch_npu-2.7.1.dev20251209-cp310-cp310-manylinux_2_28_x86_64.whl" }
